[{"id":"cc00772.c3bab88","type":"tab","label":"WittyCloud","disabled":false,"info":""},{"id":"397fe4aa.4892ec","type":"tab","label":"WittyCloud2","disabled":false,"info":""},{"id":"13b6d67d.29235a","type":"tab","label":"OrangePi Zero","disabled":false,"info":""},{"id":"e6015fe0.d6177","type":"tab","label":"Weather","disabled":false,"info":""},{"id":"42a2ba63.3b8b64","type":"tab","label":"ESP32_1","disabled":false,"info":""},{"id":"5804f7e3.4e68d8","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"e8304c09.37807","type":"mqtt-broker","z":"","broker":"localhost","port":"1883","clientid":"","usetls":false,"compatmode":false,"keepalive":"60","cleansession":true,"willTopic":"","willQos":"0","willPayload":"","birthTopic":"","birthQos":"0","birthPayload":""},{"id":"8ad69849.ec5b68","type":"ui_group","z":"","name":"Температура","tab":"def6532b.16776","order":2,"disp":false,"width":"6"},{"id":"def6532b.16776","type":"ui_tab","z":"","name":"Температура","icon":"dashboard","order":1},{"id":"38fa827.3db747e","type":"ui_tab","z":"","name":"Свет","icon":"dashboard","order":2},{"id":"870f31fb.29937","type":"ui_group","z":"","name":"Никитына комната","tab":"38fa827.3db747e","order":2,"disp":true,"width":"6"},{"id":"cd6ca71e.71ea08","type":"ui_tab","z":"","name":"Движение","icon":"dashboard","order":3},{"id":"3c4179a9.a69e36","type":"ui_group","z":"","name":"Датчик движения на кухне","tab":"29640a72.91ea26","order":1,"disp":true,"width":"6"},{"id":"6765594b.3f62d8","type":"sqlitedb","z":0,"db":"/root/sensordata.db"},{"id":"29640a72.91ea26","type":"ui_tab","z":"","name":"Settings","icon":"dashboard"},{"id":"3236a0ee.f5683","type":"ui_group","z":"","name":"Активность на кухне","tab":"cd6ca71e.71ea08","disp":true,"width":"6"},{"id":"8c108f3b.c82ae","type":"ui_group","z":"","name":"Orange Pi","tab":"29640a72.91ea26","order":2,"disp":true,"width":"6"},{"id":"389a06d3.beaeca","type":"ui_group","z":"","name":"Термометр на улице","tab":"29640a72.91ea26","order":3,"disp":true,"width":"6"},{"id":"ffaea537.71a318","type":"ui_group","z":"","name":"Weather","tab":"29640a72.91ea26","disp":true,"width":"6"},{"id":"eae8a525.c71d48","type":"exec","z":"13b6d67d.29235a","command":"cat /sys/class/thermal/thermal_zone0/temp","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"GetProcTemp","x":300,"y":140,"wires":[["4551f038.eb572"],[],[]]},{"id":"4551f038.eb572","type":"mqtt out","z":"13b6d67d.29235a","name":"ProcTemp","topic":"","qos":"","retain":"","broker":"e8304c09.37807","x":524.0000305175781,"y":126.9999885559082,"wires":[]},{"id":"ad1b00b8.c7dcf","type":"inject","z":"13b6d67d.29235a","name":"","topic":"ProcTemp","payload":"","payloadType":"str","repeat":"1","crontab":"","once":false,"x":110,"y":140,"wires":[["eae8a525.c71d48"]]},{"id":"332f678a.86d438","type":"ui_switch","z":"cc00772.c3bab88","name":"Nik's lamp","label":"Лампа над диваном","group":"870f31fb.29937","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"WittyCloud1/relay","style":"","onvalue":"1","onvalueType":"str","onicon":"","oncolor":"","offvalue":"0","offvalueType":"str","officon":"","offcolor":"","x":716.1666107177734,"y":1096.4445295333862,"wires":[["d56a40dd.bac57","ae95abf4.6b1808"]]},{"id":"aaf52aa9.333f58","type":"ui_gauge","z":"cc00772.c3bab88","name":"","group":"8ad69849.ec5b68","order":1,"width":"3","height":"3","gtype":"gage","title":"На улице","label":"°C","format":"{{value}}","min":"-20","max":"+40","colors":["#3a31f2","#1acc2c","#ca3838"],"seg1":"10","seg2":"25","x":589.1000366210938,"y":151.60006713867188,"wires":[]},{"id":"b7baff53.01f5c","type":"mqtt in","z":"cc00772.c3bab88","name":"","topic":"WittyCloud/temp","qos":"2","broker":"e8304c09.37807","x":145.09999084472656,"y":130.1999969482422,"wires":[["aaf52aa9.333f58","d5f352b5.91289","7649eb5f.7b79e4"]]},{"id":"c309f61b.496b88","type":"mqtt in","z":"13b6d67d.29235a","name":"","topic":"ProcTemp","qos":"2","broker":"e8304c09.37807","x":80.91249084472656,"y":257.2843704223633,"wires":[["193c9bbb.4c1284"]]},{"id":"193c9bbb.4c1284","type":"ui_text","z":"13b6d67d.29235a","group":"8c108f3b.c82ae","order":1,"width":0,"height":0,"name":"","label":"Температура процессора","format":"{{msg.payload}}°C","layout":"row-spread","x":502.9093704223633,"y":258.27809715270996,"wires":[]},{"id":"751a1586.7bb21c","type":"mqtt in","z":"cc00772.c3bab88","name":"WittyCloud/light","topic":"WittyCloud/light","qos":"2","broker":"e8304c09.37807","x":172.7799949645996,"y":693.9599809646606,"wires":[["fbb40d5f.c6a87"]]},{"id":"fbb40d5f.c6a87","type":"ui_text","z":"cc00772.c3bab88","group":"870f31fb.29937","order":2,"width":0,"height":0,"name":"","label":"Датчик света","format":"{{msg.payload}}","layout":"row-spread","x":584.7799377441406,"y":693.35498046875,"wires":[]},{"id":"d5f352b5.91289","type":"ui_chart","z":"cc00772.c3bab88","name":"","group":"8ad69849.ec5b68","order":3,"width":"0","height":"0","label":"На улице за 7 дней","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"auto","ymax":"auto","removeOlder":"7","removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":718.7799072265625,"y":233.3599853515625,"wires":[["e5eb7a15.d45478"],[]]},{"id":"9692479f.e2cd38","type":"stoptimer","z":"cc00772.c3bab88","duration":"15","units":"Minute","payloadtype":"num","payloadval":"0","name":"","x":409,"y":897.1999835968018,"wires":[["332f678a.86d438"],[]]},{"id":"4b29efc9.47adc","type":"ui_button","z":"cc00772.c3bab88","name":"","group":"870f31fb.29937","order":3,"width":0,"height":0,"passthru":false,"label":"15 Min","color":"","bgcolor":"","icon":"","payload":"0","payloadType":"str","topic":"WittyCloud/input","x":136.9999008178711,"y":896.399980545044,"wires":[["ae62564e.ce0708","9692479f.e2cd38"]]},{"id":"ae95abf4.6b1808","type":"debug","z":"cc00772.c3bab88","name":"","active":false,"console":"false","complete":"false","x":930.9999465942383,"y":884.0000438690186,"wires":[]},{"id":"d56a40dd.bac57","type":"mqtt out","z":"cc00772.c3bab88","name":"Light ON/OFF","topic":"","qos":"","retain":"","broker":"e8304c09.37807","x":934.6001663208008,"y":1096.0002536773682,"wires":[]},{"id":"1c4eaf66.2cfe31","type":"ui_button","z":"cc00772.c3bab88","name":"","group":"870f31fb.29937","order":5,"width":0,"height":0,"passthru":false,"label":"1 Hour","color":"","bgcolor":"","icon":"","payload":"0","payloadType":"str","topic":"WittyCloud/input","x":135.39990997314453,"y":1020.4000129699707,"wires":[["f7d83c5a.96a3a","ae62564e.ce0708"]]},{"id":"f5b68cd1.20ea6","type":"ui_button","z":"cc00772.c3bab88","name":"","group":"870f31fb.29937","order":4,"width":0,"height":0,"passthru":false,"label":"30 Min","color":"","bgcolor":"","icon":"","payload":"0","payloadType":"str","topic":"WittyCloud/input","x":137.39990615844727,"y":960.4000091552734,"wires":[["ae62564e.ce0708","731deb51.8e7e64"]]},{"id":"b203f98f.85a788","type":"ui_button","z":"cc00772.c3bab88","name":"","group":"870f31fb.29937","order":6,"width":0,"height":0,"passthru":false,"label":"Stop","color":"red","bgcolor":"","icon":"","payload":"STOP","payloadType":"str","topic":"","x":139.39991760253906,"y":1094.4000396728516,"wires":[["9692479f.e2cd38","731deb51.8e7e64","f7d83c5a.96a3a","ae62564e.ce0708"]]},{"id":"731deb51.8e7e64","type":"stoptimer","z":"cc00772.c3bab88","duration":"30","units":"Minute","payloadtype":"num","payloadval":"0","name":"","x":409.39990997314453,"y":957.1999855041504,"wires":[["332f678a.86d438"],[]]},{"id":"f7d83c5a.96a3a","type":"stoptimer","z":"cc00772.c3bab88","duration":"1","units":"Hour","payloadtype":"num","payloadval":"0","name":"","x":401.39990997314453,"y":1013.199987411499,"wires":[["332f678a.86d438"],[]]},{"id":"ae62564e.ce0708","type":"function","z":"cc00772.c3bab88","name":"Light ON/OFF","func":"if(msg.payload === \"STOP\"){\n    msg.topic = \"WittyCloud/input\"\n    msg.payload = \"0\"\n}\nelse if(msg.payload === \"0\"){\n    msg.topic = \"WittyCloud/input\"\n    msg.payload = \"1\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":438.89990234375,"y":1094.0999755859375,"wires":[["332f678a.86d438"]]},{"id":"2747cb21.f459c4","type":"mqtt in","z":"397fe4aa.4892ec","name":"","topic":"WittyCloud2/sensorStatus","qos":"2","broker":"e8304c09.37807","x":476.30003356933594,"y":225.0666732788086,"wires":[["27ef3b0d.be65b4","e10ac79f.380718","c29ce8ea.c56078"]]},{"id":"c3541510.ee3418","type":"mqtt in","z":"397fe4aa.4892ec","name":"","topic":"WittyCloud2/light","qos":"2","broker":"e8304c09.37807","x":446.30002212524414,"y":292.0666694641113,"wires":[["27ef3b0d.be65b4","d9498f0.a62a87"]]},{"id":"27ef3b0d.be65b4","type":"debug","z":"397fe4aa.4892ec","name":"","active":false,"console":"false","complete":"payload","x":1029.300136566162,"y":83.13336849212646,"wires":[]},{"id":"cfceec3f.713a","type":"mqtt out","z":"397fe4aa.4892ec","name":"","topic":"WittyCloud2/motionSensor","qos":"","retain":"","broker":"e8304c09.37807","x":1277.3002853393555,"y":435.0003080368042,"wires":[]},{"id":"5ffe65a3.2b6bfc","type":"ui_switch","z":"397fe4aa.4892ec","name":"","label":"Alarm on/off","group":"3236a0ee.f5683","order":3,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"1","onvalueType":"str","onicon":"","oncolor":"","offvalue":"0","offvalueType":"str","officon":"","offcolor":"","x":979.300121307373,"y":434.46668243408203,"wires":[["cfceec3f.713a","499bd277.78783c"]]},{"id":"60329925.de1888","type":"mqtt in","z":"397fe4aa.4892ec","name":"","topic":"WittyCloud2/motionSensor","qos":"2","broker":"e8304c09.37807","x":474.30003356933594,"y":158.6667194366455,"wires":[["27ef3b0d.be65b4"]]},{"id":"e15eb46b.66a2f8","type":"e-mail","z":"397fe4aa.4892ec","server":"smtp.gmail.com","port":"465","secure":true,"name":"ukrduino@gmail.com","dname":"","x":997.3003120422363,"y":359.13337230682373,"wires":[]},{"id":"e10ac79f.380718","type":"function","z":"397fe4aa.4892ec","name":"Notify by email","func":"if(msg.payload === '4'){\n    msg.payload = \"Motion detected!!!\"\n    return msg;    \n}\n","outputs":1,"noerr":0,"x":757.3001022338867,"y":360.000039100647,"wires":[["825a9ad9.7a6148","e15eb46b.66a2f8"]]},{"id":"825a9ad9.7a6148","type":"function","z":"397fe4aa.4892ec","name":"Disable sensor","func":"msg.payload = \"0\";\nreturn msg;","outputs":1,"noerr":0,"x":763.3003005981445,"y":434.2000141143799,"wires":[["5ffe65a3.2b6bfc"]]},{"id":"499bd277.78783c","type":"debug","z":"397fe4aa.4892ec","name":"","active":false,"console":"false","complete":"false","x":1186.3000526428223,"y":547.1333961486816,"wires":[]},{"id":"1e9d819c.ad111e","type":"inject","z":"13b6d67d.29235a","name":"Reboot","topic":"","payload":"reboot","payloadType":"str","repeat":"","crontab":"00 00 * * *","once":false,"x":143.30002212524414,"y":407.0666780471802,"wires":[["9980f168.3b792"]]},{"id":"9980f168.3b792","type":"exec","z":"13b6d67d.29235a","command":"reboot","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":391.30003356933594,"y":408.1000289916992,"wires":[[],[],[]]},{"id":"1bb1a8f7.0f0d37","type":"file in","z":"cc00772.c3bab88","name":"restore from file","filename":"/root/temp_chart.dump","format":"utf8","chunk":false,"sendError":false,"x":345,"y":231.5,"wires":[["eb3ec2a0.27b96"]]},{"id":"e5eb7a15.d45478","type":"file","z":"cc00772.c3bab88","name":"backup to file","filename":"/root/temp_chart.dump","appendNewline":true,"createDir":false,"overwriteFile":"true","x":942,"y":225.99998092651367,"wires":[]},{"id":"e94e815b.aa6ea","type":"function","z":"cc00772.c3bab88","name":"Save data to DB","func":"var sql = \"\";\nvar d = new Date();\nvar epoch = d.getTime();\nvar outputs = [];\n\nsql = \"INSERT INTO out_temperature (temperature, unix_time) \" +\n        \"VALUES (\"+msg.payload+\",\"+epoch+\")\";\noutputs.push({topic:sql});        \n// sql = \"INSERT INTO sensor_data(device,sensor,value,epoch) \" +\n//         \"VALUES ('miflora','sunlight',\"+msg.payload.sunlight+\",\"+epoch+\")\";\n// outputs.push({topic:sql});        \n// sql = \"INSERT INTO sensor_data(device,sensor,value,epoch) \" +\n//         \"VALUES ('miflora','moisture',\"+msg.payload.moisture+\",\"+epoch+\")\";\n// outputs.push({topic:sql});        \n// sql = \"INSERT INTO sensor_data(device,sensor,value,epoch) \" +\n//         \"VALUES ('miflora','fertility',\"+msg.payload.fertility+\",\"+epoch+\")\";        \n// outputs.push({topic:sql});        \n// sql = \"INSERT INTO sensor_data(device,sensor,value,epoch) \" +\n//         \"VALUES ('miflora','battery',\"+msg.payload.battery+\",\"+epoch+\")\";        \n// outputs.push({topic:sql});        \n    \n// Update the status with current timestamp\nvar now = new Date();\nvar yyyy = now.getFullYear();\nvar mm = now.getMonth() < 9 ? \"0\" + (now.getMonth() + 1) : (now.getMonth() + 1); // getMonth() is zero-based\nvar dd  = now.getDate() < 10 ? \"0\" + now.getDate() : now.getDate();\nvar hh = now.getHours() < 10 ? \"0\" + now.getHours() : now.getHours();\nvar mmm  = now.getMinutes() < 10 ? \"0\" + now.getMinutes() : now.getMinutes();\nvar ss  = now.getSeconds() < 10 ? \"0\" + now.getSeconds() : now.getSeconds();\nnode.status({fill:\"blue\",shape:\"ring\",text:\"Last update: \"+dd + \".\" + mm + \".\" + yyyy + \" \" + hh + \":\" + mmm + \":\" + ss});    \n      \nreturn [ outputs ];","outputs":1,"noerr":0,"x":447,"y":357.5,"wires":[["7cddaa34.41a0f4"]]},{"id":"ede676f7.88dd98","type":"inject","z":"cc00772.c3bab88","name":"Startup","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"x":144.99999237060547,"y":232.49999809265137,"wires":[["1bb1a8f7.0f0d37"]]},{"id":"eb3ec2a0.27b96","type":"json","z":"cc00772.c3bab88","name":"","pretty":true,"x":538,"y":231.5,"wires":[["d5f352b5.91289"]]},{"id":"7cddaa34.41a0f4","type":"sqlite","z":"cc00772.c3bab88","mydb":"6765594b.3f62d8","name":"sensordata.db","x":649,"y":357.5,"wires":[["d6005a22.5e3978"]]},{"id":"32478cbf.186564","type":"sqlite","z":"cc00772.c3bab88","mydb":"6765594b.3f62d8","name":"sensordata.db","x":705,"y":474.5,"wires":[["d6005a22.5e3978"]]},{"id":"139147c4.1f4b28","type":"function","z":"cc00772.c3bab88","name":"Get data from DB","func":"msg.topic = \"SELECT * FROM out_temperature ORDER BY id DESC\";\nreturn msg;","outputs":1,"noerr":0,"x":467.0000228881836,"y":475.5000190734863,"wires":[["32478cbf.186564"]]},{"id":"40968813.09b568","type":"inject","z":"cc00772.c3bab88","name":"Get data from DB","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":167,"y":477.5,"wires":[["139147c4.1f4b28"]]},{"id":"d6005a22.5e3978","type":"debug","z":"cc00772.c3bab88","name":"","active":false,"console":"false","complete":"payload","x":917,"y":473,"wires":[]},{"id":"7649eb5f.7b79e4","type":"debug","z":"cc00772.c3bab88","name":"","active":false,"console":"false","complete":"false","x":532.3000335693359,"y":85.13333892822266,"wires":[]},{"id":"7b4f23a6.d4686c","type":"mqtt out","z":"cc00772.c3bab88","name":"Tempreture read Period","topic":"WittyCloud1/setReadTempPeriod","qos":"","retain":"","broker":"e8304c09.37807","x":718.2999954223633,"y":1215.9999704360962,"wires":[]},{"id":"d9498f0.a62a87","type":"ui_text","z":"397fe4aa.4892ec","group":"3236a0ee.f5683","order":1,"width":0,"height":0,"name":"","label":"Датчик света","format":"{{msg.payload}}","layout":"row-spread","x":974.0094337463379,"y":289.0155601501465,"wires":[]},{"id":"ec7c72d5.4bf3b","type":"inject","z":"cc00772.c3bab88","name":"Save data to DB","topic":"","payload":"66","payloadType":"num","repeat":"","crontab":"","once":false,"x":160.91249084472656,"y":358.38432121276855,"wires":[["e94e815b.aa6ea"]]},{"id":"63a7058b.c6c14c","type":"ui_button","z":"13b6d67d.29235a","name":"","group":"8c108f3b.c82ae","order":2,"width":"3","height":"1","passthru":false,"label":"Reboot","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":136.90936279296875,"y":484.83435821533203,"wires":[["9980f168.3b792"]]},{"id":"45d995a7.3e0f2c","type":"ui_numeric","z":"cc00772.c3bab88","name":"","label":"Период опроса датчика (милисекунд)","group":"389a06d3.beaeca","order":1,"width":0,"height":0,"passthru":true,"topic":"","format":"{{value}}","min":0,"max":"1000000","step":"10000","x":393.9093704223633,"y":1214.7372999191284,"wires":[["7b4f23a6.d4686c","3ea2df67.c639a"]]},{"id":"3ea2df67.c639a","type":"debug","z":"cc00772.c3bab88","name":"","active":false,"console":"false","complete":"false","x":696.9093704223633,"y":1324.1468410491943,"wires":[]},{"id":"4ce84d4a.0cf8c4","type":"mqtt out","z":"397fe4aa.4892ec","name":"","topic":"WittyCloud2/leds","qos":"","retain":"","broker":"e8304c09.37807","x":721.0093994140625,"y":574.015625,"wires":[]},{"id":"a0448ebd.107cf","type":"ui_switch","z":"397fe4aa.4892ec","name":"","label":"Вкл/выкл индикацию","group":"3c4179a9.a69e36","order":2,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"1","onvalueType":"str","onicon":"","oncolor":"","offvalue":"0","offvalueType":"str","officon":"","offcolor":"","x":453.0092353820801,"y":573.4819993972778,"wires":[["4ce84d4a.0cf8c4"]]},{"id":"6989abb2.6dd324","type":"mqtt out","z":"397fe4aa.4892ec","name":"Tempreture read Period","topic":"WittyCloud2/setSensorStatusPeriod","qos":"","retain":"","broker":"e8304c09.37807","x":1204.3906478881836,"y":698.0155963897705,"wires":[]},{"id":"1d3c03e7.8040fc","type":"ui_numeric","z":"397fe4aa.4892ec","name":"","label":"Период обновления статуса (милисекунд)","group":"3c4179a9.a69e36","order":1,"width":0,"height":0,"passthru":true,"topic":"","format":"{{value}}","min":0,"max":"1000000","step":"10000","x":744.0000305175781,"y":699.7528762817383,"wires":[["6989abb2.6dd324","1d88d4b6.f2716b"]]},{"id":"1d88d4b6.f2716b","type":"debug","z":"397fe4aa.4892ec","name":"","active":false,"console":"false","complete":"false","x":1187.9999694824219,"y":817.1623916625977,"wires":[]},{"id":"c29ce8ea.c56078","type":"ui_chart","z":"397fe4aa.4892ec","name":"","group":"3236a0ee.f5683","order":2,"width":0,"height":0,"label":"Активность на кухне","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"step","nodata":"","dot":false,"ymin":"0","ymax":"4","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":995.9093475341797,"y":221.5562515258789,"wires":[[],[]]},{"id":"5ef18d31.e31174","type":"inject","z":"e6015fe0.d6177","name":"Get weather","topic":"","payload":"true","payloadType":"bool","repeat":"1800","crontab":"","once":false,"x":576.0094146728516,"y":310.0156078338623,"wires":[["d51c718c.4490e"]]},{"id":"ec61cabc.587788","type":"debug","z":"e6015fe0.d6177","name":"","active":false,"console":"false","complete":"payload","x":1173.009292602539,"y":272.01562118530273,"wires":[]},{"id":"d51c718c.4490e","type":"openweathermap","z":"e6015fe0.d6177","name":"Weather ","wtype":"current","lon":"","lat":"","city":"Kherson","country":"Ukraine","language":"ru","x":804.0093994140625,"y":275.015625,"wires":[["c86b24b1.c864d8","ec61cabc.587788"]]},{"id":"71b66a66.26f334","type":"comment","z":"e6015fe0.d6177","name":"links","info":"https://openweathermap.org/weather-conditions","x":602.909366607666,"y":389.65616035461426,"wires":[]},{"id":"e16b5d00.ad769","type":"inject","z":"cc00772.c3bab88","name":"","topic":"","payload":"300000","payloadType":"num","repeat":"","crontab":"","once":true,"x":151.91559600830078,"y":1215.3811902999878,"wires":[["45d995a7.3e0f2c"]]},{"id":"a6171f35.17a61","type":"inject","z":"397fe4aa.4892ec","name":"","topic":"","payload":"300000","payloadType":"str","repeat":"","crontab":"","once":true,"x":452.90936279296875,"y":699.3842239379883,"wires":[["1d3c03e7.8040fc"]]},{"id":"6fff8272.bb475c","type":"debug","z":"42a2ba63.3b8b64","name":"","active":false,"console":"false","complete":"false","x":922.9124870300293,"y":328.5467748641968,"wires":[]},{"id":"ef4aab49.364768","type":"mqtt in","z":"42a2ba63.3b8b64","name":"","topic":"ESP32_1/status","qos":"2","broker":"e8304c09.37807","x":303.9093475341797,"y":338.2843704223633,"wires":[["6fff8272.bb475c","2a5d9b76.d55af4"]]},{"id":"238b90c2.f9aaa","type":"mqtt in","z":"42a2ba63.3b8b64","name":"","topic":"ESP32_1/temperature","qos":"2","broker":"e8304c09.37807","x":312.91249084472656,"y":624.287483215332,"wires":[["cc35815e.7b8eb","6fff8272.bb475c"]]},{"id":"4eac5c14.06f284","type":"mqtt in","z":"42a2ba63.3b8b64","name":"","topic":"ESP32_1/humidity","qos":"2","broker":"e8304c09.37807","x":299.9093360900879,"y":707.2842922210693,"wires":[["1611c3db.e714fc","f8813dec.fc2b5","6fff8272.bb475c"]]},{"id":"cc35815e.7b8eb","type":"ui_gauge","z":"42a2ba63.3b8b64","name":"","group":"8ad69849.ec5b68","order":2,"width":"3","height":"3","gtype":"gage","title":"В кухне","label":"units","format":"{{value}}","min":"15","max":"30","colors":["#1722f4","#00ff00","#ca3838"],"seg1":"20","seg2":"25","x":707.9124603271484,"y":621.7843704223633,"wires":[]},{"id":"1611c3db.e714fc","type":"ui_gauge","z":"42a2ba63.3b8b64","name":"","group":"8ad69849.ec5b68","order":4,"width":0,"height":0,"gtype":"gage","title":"Влажность","label":"%","format":"{{value}}","min":"30","max":"80","colors":["#ffff00","#3fa744","#4b16eb"],"seg1":"50","seg2":"60","x":719.9093475341797,"y":706.787483215332,"wires":[]},{"id":"f8813dec.fc2b5","type":"ui_chart","z":"42a2ba63.3b8b64","name":"","group":"8ad69849.ec5b68","order":5,"width":0,"height":0,"label":"Влажность за 7 дней","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"20","ymax":"70","removeOlder":"6","removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":748.9155731201172,"y":754.7593460083008,"wires":[["78622480.7e536c"],[]]},{"id":"ccb34ebe.1a94","type":"file in","z":"42a2ba63.3b8b64","name":"restore from file","filename":"/root/hum_chart.dump","format":"utf8","chunk":false,"sendError":false,"x":244.9155731201172,"y":826.1342887878418,"wires":[["6e6cd608.30b178"]]},{"id":"78622480.7e536c","type":"file","z":"42a2ba63.3b8b64","name":"save to file","filename":"/root/hum_chart.dump","appendNewline":true,"createDir":false,"overwriteFile":"true","x":1019.9092864990234,"y":827.0874710083008,"wires":[]},{"id":"6e6cd608.30b178","type":"json","z":"42a2ba63.3b8b64","name":"","pretty":true,"x":545.9155654907227,"y":825.6092872619629,"wires":[["f8813dec.fc2b5"]]},{"id":"c86b24b1.c864d8","type":"function","z":"e6015fe0.d6177","name":"Get icon id","func":"msg.payload = msg.payload.icon.substring(0, 2);\nreturn msg;","outputs":1,"noerr":0,"x":979.9155426025391,"y":414.7593193054199,"wires":[["ec61cabc.587788","ccdfea49.2aa708"]]},{"id":"ccdfea49.2aa708","type":"mqtt out","z":"e6015fe0.d6177","name":"","topic":"ESP32_1/showIcon","qos":"","retain":"","broker":"e8304c09.37807","x":1225.909309387207,"y":415.4999313354492,"wires":[]},{"id":"c5c1cc0e.fc5dc","type":"ui_button","z":"e6015fe0.d6177","name":"","group":"ffaea537.71a318","order":0,"width":0,"height":0,"passthru":true,"label":"Get weather","color":"","bgcolor":"","icon":"","payload":"true","payloadType":"bool","topic":"","x":581.9999923706055,"y":221.99999856948853,"wires":[["d51c718c.4490e"]]},{"id":"6a84fa3b.2f6514","type":"mqtt out","z":"42a2ba63.3b8b64","name":"","topic":"Weather/update","qos":"","retain":"","broker":"e8304c09.37807","x":1102.9124908447266,"y":460.49685287475586,"wires":[]},{"id":"2a5d9b76.d55af4","type":"function","z":"42a2ba63.3b8b64","name":"Trigger weather update","func":"msg.payload = true;\nreturn msg;","outputs":1,"noerr":0,"x":861.9093475341797,"y":459.75623321533203,"wires":[["6a84fa3b.2f6514","6fff8272.bb475c"]]},{"id":"7beacb3b.222644","type":"mqtt in","z":"e6015fe0.d6177","name":"","topic":"Weather/update","qos":"2","broker":"e8304c09.37807","x":310.91246795654297,"y":219.28746795654297,"wires":[["c5c1cc0e.fc5dc"]]},{"id":"436cb5c4.c6fc2c","type":"opi_in","z":"13b6d67d.29235a","name":"Pin 22 - PA2","opi":true,"enableInterrupt":"","edge":"","debounce":"","select":"OPZ","pin":"2","x":297.9124984741211,"y":654.8749256134033,"wires":[["93dd5f94.e94ed"]]},{"id":"93dd5f94.e94ed","type":"debug","z":"13b6d67d.29235a","name":"","active":true,"console":"false","complete":"false","x":566.9093780517578,"y":654.5436763763428,"wires":[]},{"id":"8a79474.44388b8","type":"inject","z":"13b6d67d.29235a","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"x":71.90937805175781,"y":655.3843460083008,"wires":[["436cb5c4.c6fc2c"]]},{"id":"57ca337f.4f87cc","type":"exec","z":"13b6d67d.29235a","command":"shutdown -h 0","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":577.9155807495117,"y":723.0342960357666,"wires":[[],[],[]]}]